---
import { profile } from '@/data/profile';
import Button from '@/components/ui/Button.astro';
import Icon from '@/components/ui/Icon.astro';

const highlights = profile.highlights;
const trustedBy = profile.trustedBy;
---

<section class="relative flex min-h-[90vh] items-center justify-center overflow-hidden">
  <!-- Background Effects -->
  <div class="gradient-hero absolute inset-0"></div>
  <div
    class="absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,hsl(var(--primary)/0.1),transparent_50%)]"
  >
  </div>

  <!-- Grid Pattern -->
  <div
    class="absolute inset-0 opacity-[0.03]"
    style="background-image: linear-gradient(hsl(var(--foreground)) 1px, transparent 1px), linear-gradient(90deg, hsl(var(--foreground)) 1px, transparent 1px); background-size: 50px 50px;"
  >
  </div>

  <div class="relative z-10 container mx-auto px-4">
    <div class="mx-auto max-w-4xl text-center">
      <!-- Terminal-style intro -->
      <div
        class="bg-code border-border animate-fade-in mb-8 inline-flex items-center gap-2 rounded-full border px-4 py-2"
      >
        <span class="bg-primary h-2 w-2 animate-pulse rounded-full"></span>
        <code class="text-muted-foreground text-sm">
          <span class="text-primary">const</span> status = <span class="text-terminal-cyan"
            >"available for opportunities"</span
          >;
        </code>
      </div>

      <!-- Name -->
      <h1 class="animate-fade-in stagger-1 mb-6 text-5xl font-bold md:text-7xl">
        <span class="text-foreground">Hi, I'm </span>
        <span class="text-primary glow-text">{profile.name.split(' ')[0]}</span>
      </h1>

      <!-- Typing Effect -->
      <div class="animate-fade-in stagger-2 mb-8 flex h-12 items-center justify-center md:h-16">
        <span class="text-muted-foreground font-mono text-2xl md:text-4xl">
          <span class="text-primary">&gt;</span>
          <span id="typewriter"></span><span class="text-primary animate-blink">_</span>
        </span>
      </div>

      <!-- Bio -->
      <p
        class="text-muted-foreground animate-fade-in stagger-3 mx-auto mb-10 max-w-2xl text-lg leading-relaxed md:text-xl"
      >
        {profile.tagline}. I build reliable, automated platforms and cut waste for teams that need
        to move fast. With <span class="text-foreground font-semibold">15+ years</span> across <span
          class="text-primary">Google</span
        >, <span class="text-primary">IOG</span>, and high-scale environments, I keep delivery safe,
        efficient, and measurable.
      </p>

      <!-- CTAs -->
      <div
        class="animate-fade-in stagger-4 mb-12 flex flex-col items-center justify-center gap-4 sm:flex-row"
      >
        <Button href="/projects" size="lg" class="group">
          See Projects
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="ml-2 h-4 w-4 transition-transform group-hover:translate-x-1"
            ><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg
          >
        </Button>
        <Button href="https://calendly.com/joshuagilman/30min" variant="outline" size="lg">
          Schedule a Call
        </Button>
      </div>

      <!-- Highlights -->
      <div
        class="animate-fade-in stagger-4 mb-10 grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-4"
      >
        {
          highlights.map((item) => (
            <div class="border-border bg-card/60 rounded-lg border p-4 text-left">
              <p class="text-muted-foreground mb-1 font-mono text-xs tracking-wide uppercase">
                {item.label}
              </p>
              <p class="text-foreground text-xl font-semibold">{item.value}</p>
              <p class="text-muted-foreground text-sm">{item.detail}</p>
            </div>
          ))
        }
      </div>

      <!-- Trusted By -->
      <div class="animate-fade-in stagger-5 mb-12 flex flex-col items-center gap-2">
        <p class="text-muted-foreground font-mono text-xs tracking-[0.2em] uppercase">Trusted by</p>
        <div class="flex flex-wrap justify-center gap-3">
          {
            trustedBy.map((name) => (
              <span class="border-border bg-secondary/40 text-muted-foreground rounded-full border px-3 py-1 text-sm">
                {name}
              </span>
            ))
          }
        </div>
      </div>

      <!-- Social Links -->
      <div class="animate-fade-in stagger-5 relative flex items-center justify-center gap-6">
        <a
          href={profile.social.github}
          target="_blank"
          rel="noopener noreferrer"
          class="text-muted-foreground hover:text-primary transition-colors"
          aria-label="GitHub"
        >
          <Icon name="github" class="h-6 w-6" />
        </a>
        <a
          href={profile.social.linkedin}
          target="_blank"
          rel="noopener noreferrer"
          class="text-muted-foreground hover:text-primary relative transition-colors"
          aria-label="LinkedIn"
        >
          <span
            class="bg-primary pointer-events-none absolute -top-3 -right-3 h-2 w-2 animate-bounce rounded-full opacity-0"
          ></span>
          <Icon name="linkedin" class="h-6 w-6" />
        </a>
        <a
          href={`mailto:${profile.email}`}
          class="text-muted-foreground hover:text-primary transition-colors"
          aria-label="Email"
        >
          <Icon name="mail" class="h-6 w-6" />
        </a>
      </div>
    </div>
  </div>
</section>

<script>
  const words = [
    'Site Reliability Engineer',
    'Infrastructure Architect',
    'Automation Enthusiast',
    'DevOps Leader',
  ];

  function startTypewriter() {
    window.__heroTypewriterCleanup?.();

    const element = document.getElementById('typewriter');
    if (!element) return;

    let wordIndex = 0;
    let currentText = '';
    let isDeleting = false;
    let timeoutId: number | undefined;
    let cancelled = false;

    function type() {
      if (cancelled) return;

      const currentWord = words[wordIndex];

      if (isDeleting) {
        currentText = currentWord.substring(0, currentText.length - 1);
      } else {
        currentText = currentWord.substring(0, currentText.length + 1);
      }

      if (element) element.textContent = currentText;

      let delta = isDeleting ? 50 : 100;

      if (!isDeleting && currentText === currentWord) {
        delta = 2000;
        isDeleting = true;
      } else if (isDeleting && currentText === '') {
        isDeleting = false;
        wordIndex = (wordIndex + 1) % words.length;
        delta = 500;
      }

      timeoutId = window.setTimeout(type, delta);
    }

    window.__heroTypewriterCleanup = () => {
      cancelled = true;
      if (timeoutId) {
        clearTimeout(timeoutId);
      }
    };

    type();
  }

  const init = () => startTypewriter();

  init();
  document.addEventListener('astro:page-load', init);
</script>

<style>
  @keyframes blink {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0;
    }
  }

  .animate-blink {
    animation: blink 1s step-end infinite;
  }
</style>
